import { CAT_QUERY_KEY } from '../../constants/urlParams';

export const updateFilterDetails = (responseFilters, filtersDetails, setFiltersDetails) => {
    if (!responseFilters || !filtersDetails?.cat) { return; }
    const updatedCat = {};
    responseFilters.forEach(filter => {
        if (filter.id === 'categories') {
            filter.items.forEach(cat => {
                if (cat.selected) {
                    updatedCat[cat.id] = ({
                        id: cat.id,
                        text: cat.text,
                        url: cat.url
                    });
                }
            });
        }
    });

    const updatedFilterDetailsCat = filtersDetails.cat.map(cat => ({ ...cat, ...updatedCat[cat.id] }));
    setFiltersDetails({ ...filtersDetails, cat: updatedFilterDetailsCat });
};

export const updateBreadcrumbsUrls = filtersDetails => filtersDetails[CAT_QUERY_KEY]?.map(cat => {
    const updatedUrl = cat.url.replace(/&?s?cat=\d+/g, '').concat(`&cat=${cat.id}`).replace('?&', '?');
    return { ...cat, url: updatedUrl };
});
